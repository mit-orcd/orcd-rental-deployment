# Fail2Ban filter to catch requests to unknown/spoofed hostnames
# Works with nginx catch-all servers that return 444
#
# The 444 status code means nginx closed the connection without response
# This happens when someone tries to access the server with wrong hostname

[Definition]

# Scan Nginx access logs for 444 responses (Connection Closed without response)
failregex = ^<HOST> -.*"(GET|POST|HEAD).*HTTP.*" 444 0

ignoreregex =

